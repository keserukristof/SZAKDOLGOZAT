{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Kristof\\\\Documents\\\\GitHub\\\\SZAKDOLGOZAT\\\\your-time-frontend\\\\src\\\\components\\\\time-table\\\\TimeTableComponent.js\";\n\n/* eslint-disable react/destructuring-assignment */\nimport * as React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport { ViewState, EditingState } from '@devexpress/dx-react-scheduler';\nimport { Scheduler, WeekView, Appointments, AppointmentForm, AppointmentTooltip, DragDropProvider, EditRecurrenceMenu, AllDayPanel, MonthView, Toolbar, TodayButton, DateNavigator, ViewSwitcher, ConfirmationDialog } from '@devexpress/dx-react-scheduler-material-ui';\nconst dragDisableIds = new Set([]);\n\nconst allowDrag = ({\n  id\n}) => !dragDisableIds.has(id);\n\nconst appointmentComponent = props => {\n  if (allowDrag(props.data)) {\n    return React.createElement(Appointments.Appointment, Object.assign({}, props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 27\n      },\n      __self: this\n    }));\n  }\n\n  return React.createElement(Appointments.Appointment, Object.assign({}, props, {\n    style: { ...props.style,\n      cursor: 'not-allowed'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30\n    },\n    __self: this\n  }));\n};\n\nclass TimeTableComponent extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n    this.state = {\n      data: [],\n      currentDate: new Date(),\n      addedAppointment: {},\n      appointmentChanges: {},\n      editingAppointmentId: undefined\n    };\n    this.onCommitChanges = this.commitChanges.bind(this);\n    this.changeAddedAppointment = this.changeAddedAppointment.bind(this);\n    this.changeAppointmentChanges = this.changeAppointmentChanges.bind(this);\n    this.changeEditingAppointmentId = this.changeEditingAppointmentId.bind(this);\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    fetch('/api/appointments').then(res => res.json()).then(appointments => {\n      if (appointments) {\n        for (const appointment of appointments) {\n          appointment.startDate = new Date(appointment.startDate);\n          appointment.endDate = new Date(appointment.endDate);\n        }\n      }\n\n      this.setState({\n        data: appointments\n      }, () => {\n        console.log('Appointments fetched', appointments);\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  changeAddedAppointment(addedAppointment) {\n    this.setState({\n      addedAppointment\n    });\n  }\n\n  changeAppointmentChanges(appointmentChanges) {\n    this.setState({\n      appointmentChanges\n    });\n  }\n\n  changeEditingAppointmentId(editingAppointmentId) {\n    this.setState({\n      editingAppointmentId\n    });\n  }\n\n  commitChanges({\n    added,\n    changed,\n    deleted\n  }) {\n    this.setState(state => {\n      let {\n        data\n      } = state;\n\n      if (added) {\n        const startingAddedId = data.length > 0 ? data[data.length - 1].id + 1 : 0;\n        data = [...data, {\n          id: startingAddedId,\n          ...added\n        }];\n        fetch('http://localhost:5000/api/appointments', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(data[data.length - 1])\n        }).then(result => {\n          console.log(result);\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n\n      if (changed) {\n        data = data.map(appointment => changed[appointment.id] ? { ...appointment,\n          ...changed[appointment.id]\n        } : appointment);\n        fetch('http://localhost:5000/api/appointments', {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(data[changed.json.id])\n        }).then(result => {\n          console.log(result);\n        }).catch(err => {\n          console.log(err);\n        });\n        console.log(changed);\n      }\n\n      if (deleted !== undefined) {\n        let deletedId;\n        data = data.filter(appointment => {\n          if (appointment.id === deleted) {\n            deletedId = appointment.id;\n          }\n\n          return appointment.id !== deleted;\n        });\n        fetch('http://localhost:5000/api/appointments/', {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            id: deletedId\n          })\n        }).then(response => console.log(response)).catch(err => console.log(err));\n      }\n\n      return {\n        data\n      };\n    });\n  }\n\n  render() {\n    const {\n      data,\n      currentDate,\n      addedAppointment,\n      appointmentChanges,\n      editingAppointmentId\n    } = this.state;\n    return React.createElement(Paper, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(Scheduler, {\n      data: data,\n      height: 750,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(ViewState, {\n      defaultCurrentDate: currentDate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }), React.createElement(EditingState, {\n      onCommitChanges: this.onCommitChanges,\n      addedAppointment: addedAppointment,\n      onAddedAppointmentChange: this.changeAddedAppointment,\n      appointmentChanges: appointmentChanges,\n      onAppointmentChangesChange: this.changeAppointmentChanges,\n      editingAppointmentId: editingAppointmentId,\n      onEditingAppointmentIdChange: this.changeEditingAppointmentId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }), React.createElement(WeekView, {\n      startDayHour: 7,\n      endDayHour: 20,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }), React.createElement(MonthView, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }), React.createElement(AllDayPanel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }), React.createElement(EditRecurrenceMenu, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }), React.createElement(ConfirmationDialog, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }), React.createElement(Toolbar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }), React.createElement(TodayButton, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }), React.createElement(DateNavigator, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }), React.createElement(ViewSwitcher, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }), React.createElement(ConfirmationDialog, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }), React.createElement(Appointments, {\n      appointmentComponent: appointmentComponent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }), React.createElement(AppointmentTooltip, {\n      showOpenButton: true,\n      showDeleteButton: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }), React.createElement(AppointmentForm, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }), React.createElement(DragDropProvider, {\n      allowDrag: allowDrag,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default TimeTableComponent;","map":{"version":3,"sources":["C:/Users/Kristof/Documents/GitHub/SZAKDOLGOZAT/your-time-frontend/src/components/time-table/TimeTableComponent.js"],"names":["React","Paper","ViewState","EditingState","Scheduler","WeekView","Appointments","AppointmentForm","AppointmentTooltip","DragDropProvider","EditRecurrenceMenu","AllDayPanel","MonthView","Toolbar","TodayButton","DateNavigator","ViewSwitcher","ConfirmationDialog","dragDisableIds","Set","allowDrag","id","has","appointmentComponent","props","data","style","cursor","TimeTableComponent","PureComponent","constructor","_isMounted","state","currentDate","Date","addedAppointment","appointmentChanges","editingAppointmentId","undefined","onCommitChanges","commitChanges","bind","changeAddedAppointment","changeAppointmentChanges","changeEditingAppointmentId","componentDidMount","fetch","then","res","json","appointments","appointment","startDate","endDate","setState","console","log","componentWillUnmount","added","changed","deleted","startingAddedId","length","method","headers","body","JSON","stringify","result","catch","err","map","deletedId","filter","response","render"],"mappings":"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","sourcesContent":["/* eslint-disable react/destructuring-assignment */\r\nimport * as React from 'react';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { ViewState, EditingState } from '@devexpress/dx-react-scheduler';\r\nimport {\r\n  Scheduler,\r\n  WeekView,\r\n  Appointments,\r\n  AppointmentForm,\r\n  AppointmentTooltip,\r\n  DragDropProvider,\r\n  EditRecurrenceMenu,\r\n  AllDayPanel,\r\n  MonthView,\r\n  Toolbar,\r\n  TodayButton,\r\n  DateNavigator,\r\n  ViewSwitcher,\r\n  ConfirmationDialog,\r\n} from '@devexpress/dx-react-scheduler-material-ui';\r\n\r\nconst dragDisableIds = new Set([]);\r\n\r\nconst allowDrag = ({ id }) => !dragDisableIds.has(id);\r\nconst appointmentComponent = (props) => {\r\n  if (allowDrag(props.data)) {\r\n    return <Appointments.Appointment {...props} />;\r\n  }\r\n  return (\r\n    <Appointments.Appointment\r\n      {...props}\r\n      style={{ ...props.style, cursor: 'not-allowed' }}\r\n    />\r\n  );\r\n};\r\n\r\nclass TimeTableComponent extends React.PureComponent {\r\n  _isMounted = false;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      data: [],\r\n      currentDate: new Date(),\r\n\r\n      addedAppointment: {},\r\n      appointmentChanges: {},\r\n      editingAppointmentId: undefined,\r\n    };\r\n\r\n    this.onCommitChanges = this.commitChanges.bind(this);\r\n    this.changeAddedAppointment = this.changeAddedAppointment.bind(this);\r\n    this.changeAppointmentChanges = this.changeAppointmentChanges.bind(this);\r\n    this.changeEditingAppointmentId = this.changeEditingAppointmentId.bind(\r\n      this\r\n    );\r\n  }\r\n\r\n  componentDidMount() {\r\n    this._isMounted = true;\r\n    fetch('/api/appointments')\r\n      .then((res) => res.json())\r\n      .then((appointments) => {\r\n        if (appointments) {\r\n          for (const appointment of appointments) {\r\n            appointment.startDate = new Date(appointment.startDate);\r\n            appointment.endDate = new Date(appointment.endDate);\r\n          }\r\n        }\r\n        this.setState({ data: appointments }, () => {\r\n          console.log('Appointments fetched', appointments);\r\n        });\r\n      });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  changeAddedAppointment(addedAppointment) {\r\n    this.setState({ addedAppointment });\r\n  }\r\n\r\n  changeAppointmentChanges(appointmentChanges) {\r\n    this.setState({ appointmentChanges });\r\n  }\r\n\r\n  changeEditingAppointmentId(editingAppointmentId) {\r\n    this.setState({ editingAppointmentId });\r\n  }\r\n\r\n  commitChanges({ added, changed, deleted }) {\r\n    this.setState((state) => {\r\n      let { data } = state;\r\n      if (added) {\r\n        const startingAddedId =\r\n          data.length > 0 ? data[data.length - 1].id + 1 : 0;\r\n        data = [...data, { id: startingAddedId, ...added }];\r\n        fetch('http://localhost:5000/api/appointments', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(data[data.length - 1]),\r\n        })\r\n          .then((result) => {\r\n            console.log(result);\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }\r\n      if (changed) {\r\n        data = data.map((appointment) =>\r\n          changed[appointment.id]\r\n            ? { ...appointment, ...changed[appointment.id] }\r\n            : appointment\r\n        );\r\n\r\n        fetch('http://localhost:5000/api/appointments', {\r\n          method: 'PUT',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(data[changed.json.id]),\r\n        })\r\n          .then((result) => {\r\n            console.log(result);\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n        console.log(changed);\r\n      }\r\n      if (deleted !== undefined) {\r\n        let deletedId;\r\n        data = data.filter((appointment) => {\r\n          if (appointment.id === deleted) {\r\n            deletedId = appointment.id;\r\n          }\r\n          return appointment.id !== deleted;\r\n        });\r\n        fetch('http://localhost:5000/api/appointments/', {\r\n          method: 'DELETE',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ id: deletedId }),\r\n        })\r\n          .then((response) => console.log(response))\r\n          .catch((err) => console.log(err));\r\n      }\r\n      return { data };\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      data,\r\n      currentDate,\r\n      addedAppointment,\r\n      appointmentChanges,\r\n      editingAppointmentId,\r\n    } = this.state;\r\n\r\n    return (\r\n      <Paper>\r\n        <Scheduler data={data} height={750}>\r\n          <ViewState defaultCurrentDate={currentDate} />\r\n          <EditingState\r\n            onCommitChanges={this.onCommitChanges}\r\n            addedAppointment={addedAppointment}\r\n            onAddedAppointmentChange={this.changeAddedAppointment}\r\n            appointmentChanges={appointmentChanges}\r\n            onAppointmentChangesChange={this.changeAppointmentChanges}\r\n            editingAppointmentId={editingAppointmentId}\r\n            onEditingAppointmentIdChange={this.changeEditingAppointmentId}\r\n          />\r\n          <WeekView startDayHour={7} endDayHour={20} />\r\n          <MonthView />\r\n          <AllDayPanel />\r\n          <EditRecurrenceMenu />\r\n          <ConfirmationDialog />\r\n          <Toolbar />\r\n          <TodayButton />\r\n          <DateNavigator />\r\n          <ViewSwitcher />\r\n          <ConfirmationDialog />\r\n          <Appointments appointmentComponent={appointmentComponent} />\r\n          <AppointmentTooltip showOpenButton showDeleteButton />\r\n          <AppointmentForm />\r\n          <DragDropProvider allowDrag={allowDrag} />\r\n        </Scheduler>\r\n      </Paper>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TimeTableComponent;\r\n"]},"metadata":{},"sourceType":"module"}